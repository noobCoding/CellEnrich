myf <- function(text){
  return(strsplit(text, '\n')[[1]])
}



# plot2

{

c1b <- myf('Allograft rejection
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
B cell receptor signaling pathway
Cell adhesion molecules (CAMs)
Epstein-Barr virus infection
Graft-versus-host disease
Hematopoietic cell lineage
Human T-cell leukemia virus 1 infection
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Phagosome
Protein export
Rheumatoid arthritis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Th1 and Th2 cell differentiation
Th17 cell differentiation
Toxoplasmosis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

c1cd14 <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Bacterial invasion of epithelial cells
Cardiac muscle contraction
Drug metabolism
Endocytosis
Fc gamma R-mediated phagocytosis
Ferroptosis
Fluid shear stress and atherosclerosis
Glycolysis / Gluconeogenesis
Graft-versus-host disease
Hematopoietic cell lineage
Huntington disease
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Leukocyte transendothelial migration
Lysosome
Necroptosis
Non-alcoholic fatty liver disease (NAFLD)
Osteoclast differentiation
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Salmonella infection
Shigellosis
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Vibrio cholerae infection
Viral myocarditis
')
c1cd8 <- myf('Antigen processing and presentation
Cell adhesion molecules (CAMs)
Endocytosis
Epstein-Barr virus infection
Graft-versus-host disease
Human cytomegalovirus infection
Human immunodeficiency virus 1 infection
Human T-cell leukemia virus 1 infection
Leukocyte transendothelial migration
Natural killer cell mediated cytotoxicity
Parkinson disease
Primary immunodeficiency
Proteasome
Protein export
Protein processing in endoplasmic reticulum
Spliceosome
Th1 and Th2 cell differentiation
Th17 cell differentiation
')

c1dc <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Bacterial invasion of epithelial cells
Cardiac muscle contraction
Cell adhesion molecules (CAMs)
Drug metabolism
Endocytosis
Epstein-Barr virus infection
Glycolysis / Gluconeogenesis
Graft-versus-host disease
Hematopoietic cell lineage
Human immunodeficiency virus 1 infection
Human T-cell leukemia virus 1 infection
Huntington disease
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Leukocyte transendothelial migration
Necroptosis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Protein export
Protein processing in endoplasmic reticulum
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Ribosome
RNA transport
Salmonella infection
Shigellosis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Toxoplasmosis
Tuberculosis
Type I diabetes mellitus
Vibrio cholerae infection
Viral myocarditis
')

c1fcgr <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Bacterial invasion of epithelial cells
Cardiac muscle contraction
Cell adhesion molecules (CAMs)
Drug metabolism
Endocytosis
Epstein-Barr virus infection
Fc gamma R-mediated phagocytosis
Ferroptosis
Graft-versus-host disease
Human immunodeficiency virus 1 infection
Huntington disease
Influenza A
Intestinal immune network for IgA production
Kaposi sarcoma-associated herpesvirus infection
Leishmaniasis
Leukocyte transendothelial migration
Lysosome
Natural killer cell mediated cytotoxicity
Necroptosis
NOD-like receptor signaling pathway
Non-alcoholic fatty liver disease (NAFLD)
Osteoclast differentiation
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Platelet activation
Proteasome
Protein export
Regulation of actin cytoskeleton
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Salmonella infection
Shigellosis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Vibrio cholerae infection
Viral myocarditis
')

c1mem <- myf('Alzheimer disease
Autophagy
Human immunodeficiency virus 1 infection
Huntington disease
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Protein processing in endoplasmic reticulum
Ribosome
Spliceosome
Thermogenesis
')

c1naive <- myf('Ribosome
')

c1nk <- myf('Alzheimer disease
Antigen processing and presentation
Apoptosis
Autophagy
Bacterial invasion of epithelial cells
Endocytosis
Graft-versus-host disease
Human cytomegalovirus infection
Human immunodeficiency virus 1 infection
Leukocyte transendothelial migration
Natural killer cell mediated cytotoxicity
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Proteasome
Protein export
Protein processing in endoplasmic reticulum
Retrograde endocannabinoid signaling
Salmonella infection
Shigellosis
Spliceosome
Viral myocarditis
')

c1plate <- myf('Bacterial invasion of epithelial cells
Cardiac muscle contraction
Dilated cardiomyopathy (DCM)
Endocytosis
Fc gamma R-mediated phagocytosis
Ferroptosis
Focal adhesion
Gap junction
Glutathione metabolism
Human cytomegalovirus infection
Hypertrophic cardiomyopathy (HCM)
Leukocyte transendothelial migration
Necroptosis
Pancreatic secretion
Pathogenic Escherichia coli infection
Phagosome
Platelet activation
Rap1 signaling pathway
Regulation of actin cytoskeleton
Salmonella infection
Shigellosis
Synaptic vesicle cycle
Tight junction
Vascular smooth muscle contraction
Vibrio cholerae infection
Viral carcinogenesis
')
}


{

  c3b <- myf('Allograft rejection
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Cell adhesion molecules (CAMs)
Epstein-Barr virus infection
Graft-versus-host disease
Hematopoietic cell lineage
Human T-cell leukemia virus 1 infection
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Phagosome
Rheumatoid arthritis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Th1 and Th2 cell differentiation
Th17 cell differentiation
Toxoplasmosis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')


  c3cd14 <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Cardiac muscle contraction
Drug metabolism
Graft-versus-host disease
Huntington disease
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Salmonella infection
Shigellosis
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c3cd8 <- myf('Antigen processing and presentation
Epstein-Barr virus infection
Huntington disease
Parkinson disease
Proteasome
Spliceosome
')

  c3dc <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Cardiac muscle contraction
Cell adhesion molecules (CAMs)
Drug metabolism
Epstein-Barr virus infection
Glycolysis / Gluconeogenesis
Graft-versus-host disease
Hematopoietic cell lineage
Huntington disease
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Protein export
Protein processing in endoplasmic reticulum
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Ribosome
Salmonella infection
Shigellosis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c3fcgr <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Bacterial invasion of epithelial cells
Cardiac muscle contraction
Drug metabolism
Endocytosis
Epstein-Barr virus infection
Fc gamma R-mediated phagocytosis
Graft-versus-host disease
Huntington disease
Influenza A
Leishmaniasis
Leukocyte transendothelial migration
Necroptosis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Salmonella infection
Shigellosis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c3mem <- myf('Alzheimer disease
Huntington disease
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Ribosome
Spliceosome
Thermogenesis
')

  c3naive <- myf('Ribosome
')

  c3nk <- myf('Alzheimer disease
Antigen processing and presentation
Autophagy
Graft-versus-host disease
Human immunodeficiency virus 1 infection
Natural killer cell mediated cytotoxicity
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Proteasome
Salmonella infection
Spliceosome
Viral myocarditis
')

  c3plate <- myf('Dilated cardiomyopathy (DCM)
Focal adhesion
Leukocyte transendothelial migration
Pathogenic Escherichia coli infection
Phagosome
Platelet activation
Regulation of actin cytoskeleton
Shigellosis
Tight junction
')
}


{
  c5b <- myf('Allograft rejection
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Cell adhesion molecules (CAMs)
Epstein-Barr virus infection
Graft-versus-host disease
Hematopoietic cell lineage
Human T-cell leukemia virus 1 infection
Inflammatory bowel disease (IBD)
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Phagosome
Rheumatoid arthritis
Spliceosome
Staphylococcus aureus infection
Systemic lupus erythematosus
Th1 and Th2 cell differentiation
Th17 cell differentiation
Toxoplasmosis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c5cd14 <- myf('Alzheimer disease
Antigen processing and presentation
Asthma
Autophagy
Huntington disease
Leishmaniasis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Phagosome
Rheumatoid arthritis
Salmonella infection
Thermogenesis
Tuberculosis
Viral myocarditis
')

  c5cd8 <- myf('Parkinson disease
Spliceosome
')

  c5dc <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Cardiac muscle contraction
Drug metabolism
Epstein-Barr virus infection
Graft-versus-host disease
Huntington disease
Influenza A
Intestinal immune network for IgA production
Leishmaniasis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Retrograde endocannabinoid signaling
Rheumatoid arthritis
Ribosome
Salmonella infection
Shigellosis
Spliceosome
Systemic lupus erythematosus
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c5fcgr <- myf('Allograft rejection
Alzheimer disease
Antigen processing and presentation
Asthma
Autoimmune thyroid disease
Autophagy
Cardiac muscle contraction
Epstein-Barr virus infection
Huntington disease
Influenza A
Leishmaniasis
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Pathogenic Escherichia coli infection
Phagosome
Proteasome
Retrograde endocannabinoid signaling
Salmonella infection
Shigellosis
Spliceosome
Staphylococcus aureus infection
Thermogenesis
Tuberculosis
Type I diabetes mellitus
Viral myocarditis
')

  c5mem <- myf('Autophagy
Huntington disease
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Ribosome
Spliceosome
')

  c5naive <- myf('Ribosome
')

  c5nk <- myf('Autophagy
Natural killer cell mediated cytotoxicity
Non-alcoholic fatty liver disease (NAFLD)
Oxidative phosphorylation
Parkinson disease
Proteasome
Spliceosome
')

  c5plate <- myf('Focal adhesion
Leukocyte transendothelial migration
Pathogenic Escherichia coli infection
Phagosome
Platelet activation
Regulation of actin cytoskeleton
Shigellosis
Tight junction
')


}

c1 <- data.frame()
c1 <- rbind(c1, data.frame(Pathway = c1b, Cell='B'))
c1 <- rbind(c1, data.frame(Pathway = c1cd14, Cell='CD14Mono'))
c1 <- rbind(c1, data.frame(Pathway = c1cd8, Cell='CD8T'))
c1 <- rbind(c1, data.frame(Pathway = c1dc, Cell='DC'))
c1 <- rbind(c1, data.frame(Pathway = c1fcgr, Cell='fcgr'))
c1 <- rbind(c1, data.frame(Pathway = c1mem, Cell='memory'))
c1 <- rbind(c1, data.frame(Pathway = c1naive, Cell='naive'))
c1 <- rbind(c1, data.frame(Pathway = c1nk, Cell='NK'))
c1 <- rbind(c1, data.frame(Pathway = c1plate, Cell='platelet'))
c1$Param <- '0.1'

c3 <- data.frame()
c3 <- rbind(c3, data.frame(Pathway = c3b, Cell='B'))
c3 <- rbind(c3, data.frame(Pathway = c3cd14, Cell='CD14Mono'))
c3 <- rbind(c3, data.frame(Pathway = c3cd8, Cell='CD8T'))
c3 <- rbind(c3, data.frame(Pathway = c3dc, Cell='DC'))
c3 <- rbind(c3, data.frame(Pathway = c3fcgr, Cell='fcgr'))
c3 <- rbind(c3, data.frame(Pathway = c3mem, Cell='memory'))
c3 <- rbind(c3, data.frame(Pathway = c3naive, Cell='naive'))
c3 <- rbind(c3, data.frame(Pathway = c3nk, Cell='NK'))
c3 <- rbind(c3, data.frame(Pathway = c3plate, Cell='platelet'))
c3$Param <- '0.3'

c5 <- data.frame()
c5 <- rbind(c5, data.frame(Pathway = c5b, Cell='B'))
c5 <- rbind(c5, data.frame(Pathway = c5cd14, Cell='CD14Mono'))
c5 <- rbind(c5, data.frame(Pathway = c5cd8, Cell='CD8T'))
c5 <- rbind(c5, data.frame(Pathway = c5dc, Cell='DC'))
c5 <- rbind(c5, data.frame(Pathway = c5fcgr, Cell='fcgr'))
c5 <- rbind(c5, data.frame(Pathway = c5mem, Cell='memory'))
c5 <- rbind(c5, data.frame(Pathway = c5naive, Cell='naive'))
c5 <- rbind(c5, data.frame(Pathway = c5nk, Cell='NK'))
c5 <- rbind(c5, data.frame(Pathway = c5plate, Cell='platelet'))
c5$Param <- '0.5'
datas <- rbind(c1,c3,c5)
datas2 <- datas %>% group_by(Param, Cell) %>% summarise(Count = n())
ggplot(datas2, aes(x = Cell, y = Count, fill = Param)) +
  geom_bar(stat = 'identity', position = position_dodge()) +
  geom_text(aes(label = Count), position = position_dodge(0.9), vjust = -1 )


data0.5 <- datas %>% filter(Param=='0.5') %>% group_by(Pathway) %>% summarise(Count = n())
data0.3 <- datas %>% filter(Param=='0.3') %>% group_by(Pathway) %>% summarise(Count = n())
data0.1 <- datas %>% filter(Param=='0.1') %>% group_by(Pathway) %>% summarise(Count = n())

data0.5$Param <- '0.5'
data0.3$Param <- '0.3'
data0.1$Param <- '0.1'

datai <- rbind(data0.5, data0.3, data0.1)
datai$Param <- factor(datai$Param, levels = c('0.5', '0.3', '0.1'), ordered = TRUE)
ggplot(datai , aes(x = Param, y = Count, group = Param, fill = Param)) +
  geom_boxplot(width = 0.3)+
  scale_fill_manual(values = c('#74b9ff', '#a29bfe', '#fd79a8'))
